#!/usr/bin/gnuplot -persist
#Gnuplot script for plotting vertical remapping profiles diagnostics
#By Manuel Valera 05/30/17

#Defining error phi_max = ( max(phi) - max(phi_0) ) / ( max(phi_0)-min(phi_0) )
# phi_min = ( min(phi) - min(phi_0) ) / ( max(phi_0) - min(phi_0) )
# l_inf = max|phi - phi_0| / max|phi_0|

set terminal pngcairo enhanced font 'Verdana,10'
set output "dpu_error.png"
set multiplot layout 3, 1 title "{/Symbol D}p*u error" font ",12";


set title " {/Symbol F}_{max}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key right bottom
set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpu_errors.dat' u 1 w lp t "T_cons",\
'/scratch/cluster/mvalera/vrmp/run/dpu_errors_TE.dat' u 1 w lp t "TE_cons"

set title " l_{inf}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpu_errors.dat' u 3 w lp t "T_cons",\
'/scratch/cluster/mvalera/vrmp/run/dpu_errors_TE.dat' u 3 w lp t "TE_cons"

set title " l_{2}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpu_errors.dat' u 4 w lp t "T_cons",\
'/scratch/cluster/mvalera/vrmp/run/dpu_errors_TE.dat' u 4 w lp t "TE_cons"


unset multiplot

set output "dpt_error.png"
set multiplot layout 3, 1 title "{/Symbol D}p*T*C_p error" font ",12";
unset logscale y

set title " {/Symbol F}_{max}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpt_errors.dat' u 1 w lp t "T_cons",\
'/scratch/cluster/mvalera/vrmp/run/dpt_errors_TE.dat' u 1 w lp t "TE_cons"

set title " l_{inf}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpt_errors.dat' u 3 w lp t "T_cons",\
'/scratch/cluster/mvalera/vrmp/run/dpt_errors_TE.dat' u 3 w lp t "TE_cons"

set title " l_{2}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpt_errors.dat' u 4 w lp t "T_cons",\
'/scratch/cluster/mvalera/vrmp/run/dpt_errors_TE.dat' u 4 w lp t "TE_cons"

unset multiplot

set output "dpk_error.png"
set multiplot layout 3, 1 title "Kinetic error" font ",12";

set title " {/Symbol F}_{max}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key right bottom
set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpk_errors.dat' u 1 w lp t "T_cons",\
'/scratch/cluster/mvalera/vrmp/run/dpk_errors_TE.dat' u 1 w lp t "TE_cons"


set title " l_{inf}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpk_errors.dat' u 3 w lp t "T_cons",\
'/scratch/cluster/mvalera/vrmp/run/dpk_errors_TE.dat' u 3 w lp t "TE_cons"

set title " l_{2}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpk_errors.dat' u 4 w lp t "T_cons",\
'/scratch/cluster/mvalera/vrmp/run/dpk_errors_TE.dat' u 4 w lp t "TE_cons"

unset multiplot
unset logscale y
set output "totals.png"
set multiplot layout 3, 1 title "Norm. Total quantities T_{cons}" font ",12";

set title " {/Symbol D}p*u "
#set xlabel "T(K)"
set ylabel "Total sum"
#set xrange auto
set format y '%g'
set key right bottom
#set logscale y

stats '/scratch/cluster/mvalera/vrmp/run/dpu_sum.dat' u 1 name "dpu"
show var dpu
plot '/scratch/cluster/mvalera/vrmp/run/dpu_sum.dat' u ($1/dpu_max) w lp t "T_cons",\



set title " {/Symbol D}p*T*C_p"
#set xlabel "T(K)"
set ylabel "Total sum"
#set xrange auto
set format y '%g'
set key right bottom
#set logscale y

stats '/scratch/cluster/mvalera/vrmp/run/dpt_sum.dat' u 1 name "dpt"
show var dpt
plot '/scratch/cluster/mvalera/vrmp/run/dpt_sum.dat' u ($1/dpt_max) w lp t "T_cons",\


set title "K"
#set xlabel "T(K)"
set ylabel "Total sum"
#set xrange auto
set format y '%g'
set key right bottom
#set logscale y

stats '/scratch/cluster/mvalera/vrmp/run/dpk_sum.dat' u 1 name "dpk"
show var dpk
plot '/scratch/cluster/mvalera/vrmp/run/dpk_sum.dat' u ($1/dpk_max) w lp t "T_cons",\


unset multiplot

set output "totals_TE.png"
set multiplot layout 3, 1 title "Norm. total quantities TE_{cons}" font ",12";

set title " {/Symbol D}p*u "
#set xlabel "T(K)"
set ylabel "Total sum"
#set xrange auto
set format y '%g'
set key right bottom
#set logscale y


stats '/scratch/cluster/mvalera/vrmp/run/dpu_sum_TE.dat' u 1 name "dpu_TE"
show var dpu_TE
plot '/scratch/cluster/mvalera/vrmp/run/dpu_sum_TE.dat' u ($1/dpu_TE_max) w lp t "TE_cons"


set title " {/Symbol D}p*T*C_p"
#set xlabel "T(K)"
set ylabel "Total sum"
#set xrange auto
set format y '%g'
set key right bottom
#set logscale y

stats '/scratch/cluster/mvalera/vrmp/run/dpt_sum_TE.dat' u 1 name "dpt_TE"
show var dpt_TE
plot '/scratch/cluster/mvalera/vrmp/run/dpt_sum_TE.dat' u ($1/dpt_TE_max) w lp t "TE_cons"

set title "K"
#set xlabel "T(K)"
set ylabel "Total sum"
#set xrange auto
set format y '%g'
set key right bottom
#set logscale y

stats '/scratch/cluster/mvalera/vrmp/run/dpk_sum_TE.dat' u 1 name "dpk_TE"
show var dpk_TE
plot '/scratch/cluster/mvalera/vrmp/run/dpk_sum_TE.dat' u ($1/dpk_TE_max) w lp t "TE_cons"

unset multiplot


