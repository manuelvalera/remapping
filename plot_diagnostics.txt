#!/usr/bin/gnuplot -persist
#Gnuplot script for plotting vertical remapping profiles diagnostics
#By Manuel Valera 05/30/17

#Defining error phi_max = ( max(phi) - max(phi_0) ) / ( max(phi_0)-min(phi_0) )
# phi_min = ( min(phi) - min(phi_0) ) / ( max(phi_0) - min(phi_0) )
# l_inf = max|phi - phi_0| / max|phi_0|

set terminal pngcairo enhanced font 'Verdana,10'
set output "dpu_error_TE.png"
set multiplot layout 3, 1 title "{/Symbol D}p*u error" font ",12";

set title " {/Symbol F}_{max}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key off #right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpu_errors.dat' u 1 w lp 

set title " {/Symbol F}_{min}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key off #right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpu_errors.dat' u 2 w lp    

set title " l_{inf}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key off #right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpu_errors.dat' u 3 w lp    

unset multiplot

set output "dpt_error_TE.png"
set multiplot layout 3, 1 title "{/Symbol D}p*T*C_p error" font ",12";

set title " {/Symbol F}_{max}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key off #right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpt_errors.dat' u 1 w lp

set title " {/Symbol F}_{min}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key off #right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpt_errors.dat' u 2 w lp

set title " l_{inf}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key off #right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpt_errors.dat' u 3 w lp

unset multiplot

set output "dpk_error_TE.png"
set multiplot layout 3, 1 title "Kinetic error" font ",12";

set title " {/Symbol F}_{max}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key off #right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpk_errors.dat' u 1 w lp

set title " {/Symbol F}_{min}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key off #right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpk_errors.dat' u 2 w lp

set title " l_{inf}"
#set xlabel "T(K)"
set ylabel "error"
#set xrange auto
set format y '%g'
set key off #right bottom
#set logscale y

plot '/scratch/cluster/mvalera/vrmp/run/dpk_errors.dat' u 3 w lp

unset multiplot


